<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tools · Juscan.jl</title><meta name="title" content="Tools · Juscan.jl"/><meta property="og:title" content="Tools · Juscan.jl"/><meta property="twitter:title" content="Tools · Juscan.jl"/><meta name="description" content="Documentation for Juscan.jl."/><meta property="og:description" content="Documentation for Juscan.jl."/><meta property="twitter:description" content="Documentation for Juscan.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Juscan.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../../tutorial/quickstart/">Quick Start</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../anndata/">Anndata Utils</a></li><li><a class="tocitem" href="../preprocessing/">Preprocessing</a></li><li class="is-active"><a class="tocitem" href>Tools</a><ul class="internal"><li><a class="tocitem" href="#highly-variable-genes"><span>highly variable genes</span></a></li><li><a class="tocitem" href="#principal-component-analysis"><span>principal component analysis</span></a></li><li><a class="tocitem" href="#clustering"><span>clustering</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Tools</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tools</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/zehua0417/Juscan.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/zehua0417/Juscan.jl/blob/main/docs/src/api/tools.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tools-Module"><a class="docs-heading-anchor" href="#Tools-Module">Tools Module</a><a id="Tools-Module-1"></a><a class="docs-heading-anchor-permalink" href="#Tools-Module" title="Permalink"></a></h1><p>The <code>tools</code> module provides essential utility functions to support various analytical workflows in single-cell and multi-omics data processing. These functions serve as building blocks for higher-level analysis by offering efficient, reusable operations that streamline common computational tasks.</p><p>Highly Variable Genes (HVG)</p><p>The module includes methods for identifying highly variable genes, which are crucial for downstream analyses such as clustering and dimensionality reduction. These functions help select informative genes by computing variability metrics across cells.</p><p>Principal Component Analysis (PCA)</p><p>PCA is a widely used dimensionality reduction technique that captures the most significant variations in the dataset. The <code>tools</code> module provides efficient implementations for computing PCA, enabling users to reduce data complexity while preserving important biological signals.</p><p>Clustering</p><p>The module supports clustering techniques to group cells based on gene expression patterns. These methods help uncover underlying cellular heterogeneity and identify distinct cell populations, facilitating biological interpretation of single-cell data.</p><p>By providing these fundamental tools, the <code>tools</code> module enhances data processing workflows, making it easier to perform robust, reproducible analyses across different stages of research.</p><ul><li><a href="#Juscan.Tl.clustering!"><code>Juscan.Tl.clustering!</code></a></li><li><a href="#Juscan.Tl.highly_variable_genes"><code>Juscan.Tl.highly_variable_genes</code></a></li><li><a href="#Juscan.Tl.highly_variable_genes!"><code>Juscan.Tl.highly_variable_genes!</code></a></li><li><a href="#Juscan.Tl.log_transform!"><code>Juscan.Tl.log_transform!</code></a></li><li><a href="#Juscan.Tl.logp1_transform!"><code>Juscan.Tl.logp1_transform!</code></a></li><li><a href="#Juscan.Tl.pca!"><code>Juscan.Tl.pca!</code></a></li><li><a href="#Juscan.Tl.subset_to_hvg!"><code>Juscan.Tl.subset_to_hvg!</code></a></li><li><a href="#Juscan.Tl.umap!"><code>Juscan.Tl.umap!</code></a></li></ul><h2 id="highly-variable-genes"><a class="docs-heading-anchor" href="#highly-variable-genes">highly variable genes</a><a id="highly-variable-genes-1"></a><a class="docs-heading-anchor-permalink" href="#highly-variable-genes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.Tl.subset_to_hvg!" href="#Juscan.Tl.subset_to_hvg!"><code>Juscan.Tl.subset_to_hvg!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subset_to_hvg!(adata::AnnData;
    layer::Union{String,Nothing} = nothing,
    n_top_genes::Int=2000,
    batch_key::Union{String,Nothing} = nothing,
    span::Float64=0.3,
    verbose::Bool=true
)</code></pre><p>Calculates highly variable genes with <code>highly_variable_genes!</code> and subsets the <code>AnnData</code> object to the calculated HVGs.  For description of input arguments, see <code>highly_variable_genes!</code></p><p><strong>Arguments</strong></p><ul><li><code>adata</code>: <code>AnnData</code> object</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>layer</code>: optional; which layer to use for calculating the HVGs. Function assumes this is a layer of counts. If <code>layer</code> is not provided, <code>adata.X</code> is used.</li><li><code>n_top_genes</code>: optional; desired number of highly variable genes. Default: 2000.</li><li><code>batch_key</code>: optional; key where to look for the batch indices in <code>adata.obs</code>. If not provided, data is treated as one batch.</li><li><code>span</code>: span to use in the loess fit for the mean-variance local regression. See the Loess.jl docs for details.</li><li><code>verbose</code>: whether or not to print info on current status</li></ul><p><strong>Returns</strong></p><ul><li><code>adata</code> object subset to the calculated HVGs, both in the countmatrix/layer data used for HVG calculation and in the <code>adata.var</code> dictionary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/f310a77a46b9b2fcb8b17d65a7b816fe211fc45a/src/tools/hvg.jl#L221-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.Tl.highly_variable_genes" href="#Juscan.Tl.highly_variable_genes"><code>Juscan.Tl.highly_variable_genes</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">highly_variable_genes(adata::AnnData;
    layer::Union{String,Nothing} = nothing,
    n_top_genes::Int=2000,
    batch_key::Union{String,Nothing} = nothing,
    span::Float64=0.3
    )</code></pre><p>Computes highly variable genes according to the workflows on <code>scanpy</code> and Seurat v3 per batch and returns a dictionary with  the information on the joint HVGs. For the in-place version, see <code>highly_variable_genes!</code></p><p>More specifically, it is the Julia re-implementation of the corresponding  <a href="https://github.com/scverse/scanpy/blob/master/scanpy/preprocessing/_highly_variable_genes.py"><code>scanpy</code> function</a> For implementation details, please check the <code>scanpy</code>/Seurat documentations or the source code of the  lower-level <code>_highly_variable_genes_seurat_v3</code> function in this package.  Results are almost identical to the <code>scanpy</code> function. The differences have been traced back to differences in  the local regression for the mean-variance relationship implemented in the Loess.jl package, that differs slightly  from the corresponding Python implementation. </p><p><strong>Arguments</strong></p><ul><li><code>adata</code>: <code>AnnData</code> object </li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>layer</code>: optional; which layer to use for calculating the HVGs. Function assumes this is a layer of counts. If <code>layer</code> is not provided, <code>adata.X</code> is used. </li><li><code>n_top_genes</code>: optional; desired number of highly variable genes. Default: 2000. </li><li><code>batch_key</code>: optional; key where to look for the batch indices in <code>adata.obs</code>. If not provided, data is treated as one batch. </li><li><code>span</code>: span to use in the loess fit for the mean-variance local regression. See the Loess.jl docs for details. </li><li><code>replace_hvgs</code>: whether or not to replace the hvg information if there are already hvgs calculated. If false, the new values are added with a &quot;_1&quot; suffix. Default:true,</li><li><code>verbose</code>: whether or not to print info on current status</li></ul><p><strong>Returns</strong></p><ul><li>a dictionary containing information on the highly variable genes, specifically containing the following keys is added: <ul><li><code>highly_variable</code>: vector of <code>Bool</code>s indicating which genes are highly variable</li><li><code>highly_variable_rank</code>: rank of the highly variable genes according to (corrected) variance </li><li><code>means</code>: vector with means of each gene</li><li><code>variances</code>: vector with variances of each gene </li><li><code>variances_norm</code>: normalized variances of each gene </li><li><code>highly_variable_nbatches</code>: if there are batches in the dataset, logs the number of batches in which each highly variable gene was actually detected as highly variable. </li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/f310a77a46b9b2fcb8b17d65a7b816fe211fc45a/src/tools/hvg.jl#L161-L199">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.Tl.highly_variable_genes!" href="#Juscan.Tl.highly_variable_genes!"><code>Juscan.Tl.highly_variable_genes!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">highly_variable_genes!(adata::AnnData;
    layer::Union{String,Nothing} = nothing,
    n_top_genes::Int=2000,
    batch_key::Union{String,Nothing} = nothing,
    span::Float64=0.3,
    replace_hvgs::Bool=true,
    verbose::Bool=false
    )</code></pre><p>Computes highly variable genes per batch according to the workflows on <code>scanpy</code> and Seurat v3 in-place.  This is the in-place version that adds an dictionary containing information on the highly variable genes directly  to the <code>adata.var</code> and returns the modified <code>AnnData</code> object.  For details, see the not-in-place version <code>?highly_variable_genes</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/f310a77a46b9b2fcb8b17d65a7b816fe211fc45a/src/tools/hvg.jl#L125-L139">source</a></section></article><h2 id="principal-component-analysis"><a class="docs-heading-anchor" href="#principal-component-analysis">principal component analysis</a><a id="principal-component-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#principal-component-analysis" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.Tl.pca!" href="#Juscan.Tl.pca!"><code>Juscan.Tl.pca!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pca!(adata::Muon.AnnData; layer=&quot;log_transformed&quot;, n_pcs=1000, key_added=&quot;pca&quot;, verbose=true)</code></pre><p>Performs Principal Component Analysis (PCA) on the specified layer of an <code>AnnData</code> object and stores the result in <code>adata.obsm</code>.</p><p>If the specified layer is missing, the function will attempt to log-transform a normalized layer, or normalize and log-transform the raw counts if needed.</p><p><strong>Arguments</strong></p><ul><li><code>adata::Muon.AnnData</code>: The annotated data object on which to perform PCA.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>layer::String = &quot;log_transformed&quot;</code>: The data layer to use for PCA. Defaults to <code>&quot;log_transformed&quot;</code>.</li><li><code>n_pcs::Int = 1000</code>: The number of principal components to compute. Automatically clipped to the smallest matrix dimension if too large.</li><li><code>key_added::String = &quot;pca&quot;</code>: The key under which to store the PCA result in <code>adata.obsm</code>.</li><li><code>verbose::Bool = true</code>: Whether to print progress messages.</li></ul><p><strong>Returns</strong></p><p>The modified <code>AnnData</code> object with PCA results stored in <code>adata.obsm[key_added]</code>.</p><p><strong>Notes</strong></p><ul><li>This function performs automatic preprocessing if the requested layer is not present.</li><li>The PCA is computed via SVD on standardized data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/f310a77a46b9b2fcb8b17d65a7b816fe211fc45a/src/tools/pca.jl#L11-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.Tl.umap!" href="#Juscan.Tl.umap!"><code>Juscan.Tl.umap!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">umap!(adata::Muon.AnnData; layer=&quot;log_transformed&quot;, use_pca=nothing, n_pcs=100, key_added=&quot;umap&quot;, verbose=true, kwargs...)</code></pre><p>Computes a UMAP embedding from the data in the specified layer or PCA representation and stores the result in <code>adata.obsm</code>.</p><p>If PCA is requested via <code>use_pca</code>, it will be computed automatically if not already present.</p><p><strong>Arguments</strong></p><ul><li><code>adata::Muon.AnnData</code>: The annotated data object on which to compute UMAP.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>layer::String = &quot;log_transformed&quot;</code>: The layer to use as input if <code>use_pca</code> is not specified.</li><li><code>use_pca::Union{String, Nothing} = nothing</code>: If specified, use this key in <code>adata.obsm</code> as PCA input. If missing, it will be computed.</li><li><code>n_pcs::Int = 100</code>: Number of principal components to use if PCA needs to be computed.</li><li><code>key_added::String = &quot;umap&quot;</code>: The key under which to store the UMAP embedding.</li><li><code>verbose::Bool = true</code>: Whether to print progress messages.</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>UMAP.UMAP_()</code>.</li></ul><p><strong>Returns</strong></p><p>The modified <code>AnnData</code> object with UMAP results stored in:</p><ul><li><code>adata.obsm[key_added]</code>: The UMAP embedding.</li><li><code>adata.obsm[&quot;knns&quot;]</code>: K-nearest neighbors matrix.</li><li><code>adata.obsm[&quot;knn_dists&quot;]</code>: KNN distance matrix.</li><li><code>adata.obsp[&quot;fuzzy_neighbor_graph&quot;]</code>: Fuzzy graph representation.</li></ul><p><strong>Notes</strong></p><ul><li>Automatically performs normalization and log transformation if necessary.</li><li>Uses the <code>UMAP.jl</code> package under the hood.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/f310a77a46b9b2fcb8b17d65a7b816fe211fc45a/src/tools/pca.jl#L74-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.Tl.log_transform!" href="#Juscan.Tl.log_transform!"><code>Juscan.Tl.log_transform!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">log_transform!(adata::Muon.AnnData; layer=&quot;normalized&quot;, key_added=&quot;log_transformed&quot;, verbose=false)</code></pre><p>Applies a log transformation to the specified data layer of an <code>AnnData</code> object and stores the result in <code>adata.layers</code>.</p><p>If the specified layer is missing, the function defaults to applying a log(1 + x) transformation to <code>adata.X</code>.</p><p><strong>Arguments</strong></p><ul><li><code>adata::Muon.AnnData</code>: The data object to transform.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>layer::String = &quot;normalized&quot;</code>: The layer to transform. Must exist in <code>adata.layers</code>.</li><li><code>key_added::String = &quot;log_transformed&quot;</code>: The key to store the result under in <code>adata.layers</code>.</li><li><code>verbose::Bool = false</code>: Whether to print messages during the process.</li></ul><p><strong>Returns</strong></p><p>The modified <code>AnnData</code> object with the log-transformed data added to <code>adata.layers[key_added]</code>.</p><p><strong>Notes</strong></p><ul><li>The transformation is log(x + ϵ), where ϵ is a small constant to avoid log(0).</li><li>For default fallback behavior, see <code>logp1_transform!()</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/f310a77a46b9b2fcb8b17d65a7b816fe211fc45a/src/tools/pca.jl#L142-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.Tl.logp1_transform!" href="#Juscan.Tl.logp1_transform!"><code>Juscan.Tl.logp1_transform!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">logp1_transform!(adata::Muon.AnnData; layer=nothing, key_added=&quot;log1_transformed&quot;, verbose=false)</code></pre><p>Applies a log(1 + x) transformation to the specified layer or the main data matrix <code>adata.X</code> in an <code>AnnData</code> object. The result is stored in <code>adata.layers[key_added]</code>.</p><p><strong>Arguments</strong></p><ul><li><code>adata::Muon.AnnData</code>: The annotated data object to transform.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>layer::Union{String, Nothing} = nothing</code>: The name of the data layer to transform. If <code>nothing</code> or the layer is missing, uses <code>adata.X</code>.</li><li><code>key_added::AbstractString = &quot;log1_transformed&quot;</code>: The name under which to store the transformed result in <code>adata.layers</code>.</li><li><code>verbose::Bool = false</code>: Whether to print transformation messages.</li></ul><p><strong>Returns</strong></p><p>The modified <code>AnnData</code> object with the log(1 + x) transformed data stored in <code>adata.layers[key_added]</code>.</p><p><strong>Notes</strong></p><ul><li>This transformation is commonly used to stabilize variance and reduce the effect of outliers.</li><li>Compared to <code>log_transform!</code>, this version adds 1 to the data before taking the logarithm, making it more robust to zero entries.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/f310a77a46b9b2fcb8b17d65a7b816fe211fc45a/src/tools/pca.jl#L184-L204">source</a></section></article><h2 id="clustering"><a class="docs-heading-anchor" href="#clustering">clustering</a><a id="clustering-1"></a><a class="docs-heading-anchor-permalink" href="#clustering" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.Tl.clustering!" href="#Juscan.Tl.clustering!"><code>Juscan.Tl.clustering!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clustering!(data::Muon.AnnData; kwargs...)</code></pre><p>Perform clustering on a <code>Muon.AnnData</code> object and store the results in place.</p><p>This function supports modularity-based graph clustering (<code>&quot;mc&quot;</code>) and K-means clustering (<code>&quot;km&quot;</code>). By default, modularity clustering is applied using a shared nearest neighbor (SNN) graph constructed from PCA-reduced data.</p><p><strong>Arguments</strong></p><ul><li><code>data::Muon.AnnData</code>: The annotated data matrix to cluster. The object will be modified in place.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>method::AbstractString = &quot;mc&quot;</code>: Clustering method. Options are <code>&quot;mc&quot;</code> (modularity clustering) or <code>&quot;km&quot;</code> (K-means).</li><li><code>reduction::Union{AbstractString, Symbol} = :auto</code>: Dimensionality reduction method to use. Accepts <code>&quot;pca&quot;</code> or <code>&quot;harmony&quot;</code>. When <code>:auto</code>, it defaults to <code>&quot;pca&quot;</code> (support for <code>&quot;harmony&quot;</code> is planned).</li><li><code>use_pca::Union{AbstractString, Integer} = &quot;pca_cut&quot;</code>: Number of principal components to use, or the key in <code>obsm</code> specifying a PCA representation.</li><li><code>tree_K::Integer = 20</code>: Number of neighbors to use when building the SNN graph. Relevant only for <code>&quot;mc&quot;</code> clustering.</li><li><code>resolution::Union{Symbol, Real, AbstractRange} = :auto</code>: Resolution(s) for modularity optimization. <code>:auto</code> uses <code>0.2:0.1:2.0</code>.</li><li><code>cluster_K::Union{Nothing, Integer} = nothing</code>: Number of clusters for K-means. If <code>nothing</code>, it will be auto-determined.</li><li><code>cluster_K_max::Union{Nothing, Integer} = 30</code>: Maximum number of clusters to try for automatic K-means clustering.</li><li><code>dist::AbstractString = &quot;Euclidean&quot;</code>: Distance metric for K-means, e.g., <code>&quot;Euclidean&quot;</code>.</li><li><code>network::AbstractString = &quot;SNN&quot;</code>: Type of graph network to construct. Currently supports <code>&quot;SNN&quot;</code>.</li><li><code>random_starts_number::Integer = 10</code>: Number of random initializations for clustering (modularity clustering only).</li><li><code>iter_number::Integer = 10</code>: Maximum number of iterations for the clustering optimization.</li><li><code>prune::AbstractFloat = 1/15</code>: Pruning factor for the graph. Must be between 0 and 1.</li><li><code>seed::Integer = -1</code>: Random seed. Use a negative number to skip setting the seed.</li></ul><p><strong>Returns</strong></p><p>Nothing. The clustering results are stored in the <code>obs</code> field of the input <code>AnnData</code> object, typically under a key like <code>&quot;clusters&quot;</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Juscan

clustering!(adata; method=&quot;mc&quot;, use_pca=&quot;X_pca&quot;, resolution=1.0)</code></pre><p><strong>Notes</strong></p><ul><li><code>&quot;harmony&quot;</code> support is planned but not yet implemented.</li><li>The <code>&quot;mc&quot;</code> method builds a neighbor graph and performs community detection; <code>&quot;km&quot;</code> performs K-means clustering in reduced space.</li><li>The <code>method</code> parameter only supports <code>&quot;mc&quot;</code> and <code>&quot;km&quot;</code>; invalid inputs will return a warning.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/f310a77a46b9b2fcb8b17d65a7b816fe211fc45a/src/tools/cluster.jl#L20-L60">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../preprocessing/">« Preprocessing</a><div class="flexbox-break"></div><p class="footer-message">Copyright © lihuax (LiZehua) Juscan.jl 2025</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Friday 4 April 2025 09:29">Friday 4 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
