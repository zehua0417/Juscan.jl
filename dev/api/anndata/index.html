<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Anndata Utils · Juscan.jl</title><meta name="title" content="Anndata Utils · Juscan.jl"/><meta property="og:title" content="Anndata Utils · Juscan.jl"/><meta property="twitter:title" content="Anndata Utils · Juscan.jl"/><meta name="description" content="Documentation for Juscan.jl."/><meta property="og:description" content="Documentation for Juscan.jl."/><meta property="twitter:description" content="Documentation for Juscan.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Juscan.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../../tutorial/quickstart/">Quick Start</a></li></ul></li><li><span class="tocitem">API</span><ul><li class="is-active"><a class="tocitem" href>Anndata Utils</a><ul class="internal"><li><a class="tocitem" href="#celltypes"><span>celltypes</span></a></li><li><a class="tocitem" href="#subset-adata"><span>subset adata</span></a></li><li><a class="tocitem" href="#insert"><span>insert</span></a></li></ul></li><li><a class="tocitem" href="../preprocessing/">Preprocessing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Anndata Utils</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Anndata Utils</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/zehua0417/Juscan.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/zehua0417/Juscan.jl/blob/main/docs/src/api/anndata.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Anndata-utils"><a class="docs-heading-anchor" href="#Anndata-utils">Anndata utils</a><a id="Anndata-utils-1"></a><a class="docs-heading-anchor-permalink" href="#Anndata-utils" title="Permalink"></a></h1><p>The <code>AnnData</code> struct is imported from <a href="https://github.com/scverse/Muon.jl"><code>Muon.jl</code></a>. The package provides read and write functions for <code>.h5ad</code> and <code>.h5mu</code> files, the typical H5-based format for storing Python <code>anndata</code> objects. The <code>AnnData</code> object stores datasets together with metadata, such as information on the variables (genes in scRNA-seq data) and observations (cells), as well as different kinds of annotations and transformations of the original count matrix, such as PCA or UMAP embeddings, or graphs of observations or variables.</p><p>For details on the Julia implementation in <code>Muon.jl</code>, see the <a href="https://scverse.github.io/Muon.jl/dev/">documentation</a>.</p><p>For more details on the original Python implementation of the <code>anndata</code> object, see the <a href="https://anndata.readthedocs.io/en/latest/">documentation</a> and <a href="https://doi.org/10.1101/2021.12.16.473007">preprint</a>.</p><p><img src="../../assets/anndata_schema.svg" alt="anndata"/></p><ul><li><a href="#Juscan.get_celltypes"><code>Juscan.get_celltypes</code></a></li><li><a href="#Juscan.insert_obs!"><code>Juscan.insert_obs!</code></a></li><li><a href="#Juscan.insert_var!"><code>Juscan.insert_var!</code></a></li><li><a href="#Juscan.subset_adata"><code>Juscan.subset_adata</code></a></li><li><a href="#Juscan.subset_adata!"><code>Juscan.subset_adata!</code></a></li></ul><h2 id="celltypes"><a class="docs-heading-anchor" href="#celltypes">celltypes</a><a id="celltypes-1"></a><a class="docs-heading-anchor-permalink" href="#celltypes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.get_celltypes" href="#Juscan.get_celltypes"><code>Juscan.get_celltypes</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_celltypes(a::AnnData)</code></pre><p>Tries to infer the cell types of cells in an <code>AnnData</code> object. </p><p>Returns a vector of cell type names if the cell types are stored in  <code>adata.obs[&quot;cell_type&quot;]</code>, <code>adata.obs[&quot;celltype&quot;]</code>, <code>adata.obs[&quot;celltypes&quot;]</code>, or <code>adata.obs[&quot;cell_types&quot;]</code>.  Otherwise, returns <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/fa9543dd675f8887b40a898609f1cb7ae4040123/src/anndata.jl#L46-L54">source</a></section></article><h2 id="subset-adata"><a class="docs-heading-anchor" href="#subset-adata">subset adata</a><a id="subset-adata-1"></a><a class="docs-heading-anchor-permalink" href="#subset-adata" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.subset_adata" href="#Juscan.subset_adata"><code>Juscan.subset_adata</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subset_adata(adata::AnnData, subset_inds::Tuple, dims::Symbol=:both)</code></pre><p>Subset an <code>AnnData</code> object by indices passed as a tuple of vectors of integers, UnitRanges, or vectors of Booleans. If <code>dims</code> is set to :both, the first element of <code>subset_inds</code> is used to subset cells and the second element is used to subset genes.</p><p><strong>Arguments</strong></p><ul><li><code>adata</code>: <code>AnnData</code> object to subset</li><li><code>subset_inds</code>: tuple of vectors of integers, UnitRanges, or vectors of Booleans</li><li><code>dims</code>: dimension to subset, either <code>:cells</code>, <code>:genes</code>, or <code>:both</code></li></ul><p><strong>Returns</strong></p><ul><li>a copy of the <code>AnnData</code> object with the subsetted data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/fa9543dd675f8887b40a898609f1cb7ae4040123/src/anndata.jl#L100-L113">source</a></section><section><div><pre><code class="language-julia hljs">subset_adata(adata::AnnData, subset_inds::Union{Int, Vector{Int}, UnitRange, Vector{Bool}}, dims::Symbol)</code></pre><p>Subset an <code>AnnData</code> object by indices passed as a vector of integers or booleans or as a UnitRange.  The <code>dims</code> argument can be set to either <code>:cells</code> or <code>:genes</code> to specify which dimension to subset. </p><p><strong>Arguments</strong></p><ul><li><code>adata</code>: <code>AnnData</code> object to subset</li><li><code>subset_inds</code>: vector of integers or booleans or UnitRange</li><li><code>dims</code>: dimension to subset, either <code>:cells</code> or <code>:genes</code></li></ul><p><strong>Returns</strong></p><ul><li>a copy of the <code>AnnData</code> object with the subsetted data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/fa9543dd675f8887b40a898609f1cb7ae4040123/src/anndata.jl#L120-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.subset_adata!" href="#Juscan.subset_adata!"><code>Juscan.subset_adata!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subset_adata!(adata::AnnData, subset_inds, dims::Symbol)</code></pre><p>In-place version of <code>subset_adata</code>, see <code>?subset_adata</code> for more details. </p><p>For <code>subset_inds</code>, either a tuple of vectors or ranges can be passed with <code>dims</code> set to :both, for subsetting  both cells and genes, or a single vector or range can be passed with <code>dims</code> set to either :cells or :genes.</p><p><strong>Arguments</strong></p><ul><li><code>adata</code>: <code>AnnData</code> object to subset</li><li><code>subset_inds</code>: tuple of vectors of integers, UnitRanges, or vectors of Booleans or vector of integers or booleans or UnitRange</li><li><code>dims</code>: dimension to subset, either <code>:cells</code>, <code>:genes</code>, or <code>:both</code></li></ul><p><strong>Returns</strong></p><ul><li>the <code>AnnData</code> object with the subsetted data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/fa9543dd675f8887b40a898609f1cb7ae4040123/src/anndata.jl#L144-L159">source</a></section></article><h2 id="insert"><a class="docs-heading-anchor" href="#insert">insert</a><a id="insert-1"></a><a class="docs-heading-anchor-permalink" href="#insert" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.insert_obs!" href="#Juscan.insert_obs!"><code>Juscan.insert_obs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insert_obs!(adata::AnnData, obs::DataFrame)</code></pre><p>Insert new columns into the <code>obs</code> DataFrame of an <code>AnnData</code> object.</p><p><strong>Arguments</strong></p><ul><li><code>adata</code>: The <code>AnnData</code> object to modify.</li><li><code>obs</code>: A DataFrame containing the new columns to be inserted. The number of rows in <code>obs</code> must match the number of cells in <code>adata</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: Modifies the <code>adata.obs</code> DataFrame in place.</li></ul><p><strong>Notes</strong></p><ul><li>This function assumes that the number of rows in <code>obs</code> matches the number of cells in <code>adata</code>. If they do not match, an error will be thrown.</li><li>This function modifies the <code>adata.obs</code> DataFrame directly. If you want to keep the original <code>adata</code> unchanged, make a copy before calling this function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/fa9543dd675f8887b40a898609f1cb7ae4040123/src/anndata.jl#L252-L267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Juscan.insert_var!" href="#Juscan.insert_var!"><code>Juscan.insert_var!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insert_var!(adata::AnnData, var::DataFrame)</code></pre><p>Insert new columns into the <code>var</code> DataFrame of an <code>AnnData</code> object.</p><p><strong>Arguments</strong></p><ul><li><code>adata</code>: The <code>AnnData</code> object to modify.</li><li><code>var</code>: A DataFrame containing the new columns to be inserted. The number of rows in <code>var</code> must match the number of genes in <code>adata</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: Modifies the <code>adata.var</code> DataFrame in place.</li></ul><p><strong>Notes</strong></p><ul><li>This function assumes that the number of rows in <code>var</code> matches the number of genes in <code>adata</code>. If they do not match, an error will be thrown.</li><li>This function modifies the <code>adata.var</code> DataFrame directly. If you want to keep the original <code>adata</code> unchanged, make a copy before calling this function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zehua0417/Juscan.jl/blob/fa9543dd675f8887b40a898609f1cb7ae4040123/src/anndata.jl#L274-L289">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorial/quickstart/">« Quick Start</a><a class="docs-footer-nextpage" href="../preprocessing/">Preprocessing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 4 March 2025 16:32">Tuesday 4 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
